<section
  class="min-h-screen flex flex-col items-center bg-secondary text-primary p-6"
>
  <!-- Header fixo seguindo padrão do signup/onboarding (oculto na conclusão) -->
  <header
    *ngIf="currentStep < 4"
    class="w-full max-w-md flex items-center justify-between mt-2"
  >
    <div class="w-14 h-14 flex items-center justify-start">
      <button
        *ngIf="currentStep > 0"
        type="button"
        (click)="headerBack()"
        aria-label="Voltar"
        class="flex items-center justify-center"
      >
        <img src="/assets/arrowBack.png" alt="Voltar" class="w-10 h-10" />
      </button>
    </div>
    <div class="flex-1"></div>
    <div
      class="w-20 h-14 flex items-center justify-end gap-2"
      *ngIf="currentStep >= 1"
    >
      <span
        class="w-3 h-3 rounded-full transition-all"
        [ngClass]="{
          'bg-primary': currentStep >= 1,
          'bg-white': currentStep < 1
        }"
      ></span>
      <span
        class="w-3 h-3 rounded-full transition-all"
        [ngClass]="{
          'bg-primary': currentStep >= 2,
          'bg-white': currentStep < 2
        }"
      ></span>
      <span
        class="w-3 h-3 rounded-full transition-all"
        [ngClass]="{
          'bg-primary': currentStep >= 3,
          'bg-white': currentStep < 3
        }"
      ></span>
    </div>
  </header>

  <div class="w-full max-w-md flex flex-col gap-6 mt-6">
    <div *ngIf="errorMessage" class="flex flex-col gap-2 text-sm">
      <p>{{ errorMessage }}</p>
    </div>

    <app-completar-cadastro-intro
      *ngIf="currentStep === 0"
      (next)="onIntroNext()"
    ></app-completar-cadastro-intro>

    <div *ngIf="categoriasLoading" class="text-center text-sm text-description">
      Carregando categorias...
    </div>
    <div *ngIf="categoriasError" class="text-center text-sm text-error">
      {{ categoriasError }}
    </div>

    <app-step1
      *ngIf="currentStep === 1"
      (next)="onStep1Next($event)"
      (back)="onStep1Back()"
      [categorias]="categoriasReceita"
      [presetIncomes]="presetIncomesForStep"
    ></app-step1>

    <app-step2
      *ngIf="currentStep === 2"
      (next)="onStep2Next($event)"
      (back)="onStep2Back()"
      [categorias]="categoriasDespesa"
      [presetExpenses]="presetExpensesForStep"
    ></app-step2>

    <app-step3
      *ngIf="currentStep === 3"
      (next)="onStep3Next($event)"
      (back)="onStep3Back()"
      [isLoading]="isLoading"
      [presetStartDay]="presetStartDayForStep"
    ></app-step3>

    <app-conclusao *ngIf="currentStep === 4"></app-conclusao>
  </div>
</section>

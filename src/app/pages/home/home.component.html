<div class="px-4 py-5 font-inter">
  <div class="w-full max-w-md mx-auto space-y-5">
    <!-- Filtro de Período -->
    <section>
      <h2 class="text-sm font-medium text-description mb-2">Período</h2>
      <select
        [(ngModel)]="periodoSelecionado"
        (ngModelChange)="onPeriodoChange()"
        class="w-full h-12 rounded-xl border border-primary/40 bg-white px-4 text-sm font-medium focus:border-primary focus:ring-2 focus:ring-primary/20 transition"
      >
        <option *ngFor="let periodo of periodos" [value]="periodo.value">
          {{ periodo.label }}
        </option>
      </select>
    </section>

    <!-- Saldo Atual -->
    <section class="rounded-xl bg-white p-5 shadow-sm border border-black/5">
      <h2 class="text-sm font-medium text-description mb-1">Saldo atual</h2>
      <p
        class="text-4xl font-extrabold tracking-tight"
        [ngClass]="saldoAtual >= 0 ? 'text-success' : 'text-error'"
      >
        {{ saldoAtual | currency : "BRL" : "symbol" : "1.2-2" : "pt" }}
      </p>
      <p class="text-xs text-description mt-1">
        Disponível no período selecionado
      </p>
    </section>

    <!-- Receitas / Despesas -->
    <section class="grid grid-cols-2 gap-4">
      <div class="rounded-xl bg-white p-4 shadow-sm border border-black/5">
        <div class="text-xs text-description uppercase tracking-wide mb-1">
          Receitas
        </div>
        <div class="text-xl font-semibold text-success">
          {{ totalReceitas | currency : "BRL" : "symbol" : "1.0-0" : "pt" }}
        </div>
      </div>

      <div class="rounded-xl bg-white p-4 shadow-sm border border-black/5">
        <div class="text-xs text-description uppercase tracking-wide mb-1">
          Despesas
        </div>
        <div class="text-xl font-semibold text-error">
          {{ totalDespesas | currency : "BRL" : "symbol" : "1.0-0" : "pt" }}
        </div>
      </div>
    </section>

    <!-- Gráficos -->
    <section
      *ngIf="receitasChartData.length || despesasChartData.length"
      class="grid grid-cols-1 sm:grid-cols-2 gap-4"
    >
      <div
        *ngIf="receitasChartData.length"
        class="rounded-xl bg-white p-4 shadow-sm border border-black/5"
      >
        <app-pie-chart
          [data]="receitasChartData"
          [title]="'Receitas'"
          [size]="140"
          [innerInset]="26"
        />
      </div>

      <div
        *ngIf="despesasChartData.length"
        class="rounded-xl bg-white p-4 shadow-sm border border-black/5"
      >
        <app-pie-chart
          [data]="despesasChartData"
          [title]="'Despesas'"
          [size]="140"
          [innerInset]="26"
        />
      </div>
    </section>

    <!-- Gastos por Categoria -->
    <ng-container *ngIf="dashboardData as data">
      <section
        *ngIf="data.gastosPorCategoria?.length"
        class="rounded-xl bg-white p-5 shadow-sm border border-black/5"
      >
        <app-category-chart
          [gastos]="data.gastosPorCategoria"
          [title]="'Gastos por Categoria'"
        />
      </section>

      <!-- Metas -->
      <section
        *ngIf="data.metas?.length"
        class="rounded-xl bg-white p-5 shadow-sm border border-black/5"
      >
        <app-metas-summary [metas]="data.metas" [title]="'Metas'" />
      </section>
    </ng-container>

    <!-- CTA Recorrentes -->
    <section>
      <a
        [routerLink]="['/recorrentes']"
        class="flex items-center justify-between rounded-xl bg-primary px-5 py-4 shadow-sm active:scale-[0.98] transition"
      >
        <span class="font-semibold text-white"> Transações recorrentes </span>
        <mat-icon class="text-white text-base">chevron_right</mat-icon>
      </a>
    </section>

    <!-- Botão Relatório -->
    <section>
      <button
        type="button"
        (click)="openRelatorioModal()"
        class="w-full flex items-center justify-center gap-2 rounded-xl border border-primary/40 bg-white py-4 text-primary text-sm font-semibold active:scale-95 transition"
      >
        <mat-icon class="text-base">description</mat-icon>
        Gerar relatório
      </button>
    </section>

    <!-- Loading -->
    <div
      *ngIf="loading"
      class="flex justify-center py-10 text-description text-sm"
    >
      Carregando dados…
    </div>
  </div>

  <app-relatorio-modal
    [open]="isRelatorioModalOpen"
    (close)="handleRelatorioModalClose()"
    (confirm)="handleRelatorioModalConfirm($event)"
  />
</div>
